(self.webpackChunk_bulletproof_client=self.webpackChunk_bulletproof_client||[]).push([[665],{4665:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>O});var r=n(6694),a=n(1791),o=n(6700),i=n(3460),l=n(602),c=n(5346),s=n(1249),u=n(4164),d=n(4168),m=n(8989),b=n(4311),p=n(5314),f=n(8763),g=n(8209);const h=(0,g.Z)((e=>({root:{marginTop:e.spacing(3)},alert:{marginBottom:e.spacing(3)}}))),E=e=>{let{id:t,title:n}=e;const[a,l]=r.useState(n),[b,g]=r.useState(""),[E,{loading:k}]=(0,p._n)({onError:e=>g(e.message)}),y=h();return r.createElement(i.Z,{className:y.root},r.createElement(c.Z,null,r.createElement("form",{onSubmit:e=>{e.preventDefault(),k||E({variables:{id:t,title:a}})}},r.createElement(s.Z,{title:"Edit book"}),r.createElement(u.Z,null,b?r.createElement(o.Z,{onClose:()=>g(""),className:y.alert,severity:"error"},b):"",r.createElement(f.Z,{label:"title",variant:"outlined",value:a,onChange:e=>l(e.currentTarget.value)})),r.createElement(d.Z,null,r.createElement(m.Z,{disabled:k,variant:"contained",color:"primary",type:"submit"},"Save")))))},k=(0,g.Z)((e=>({alert:{marginTop:e.spacing(3)}})));function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const O=e=>{let{match:t,history:n}=e;const f=t.params.id,[g,h]=r.useState(!1),[y,v]=r.useState(""),{loading:O,data:w,error:j}=(0,p.N2)({variables:{id:f}}),[P,{loading:$}]=(0,p.tJ)({update:e=>{e.modify({fields:{books:(e,t)=>{let{readField:n}=t;const r=[];if(e.nodes){const t=e.nodes.filter((e=>n("id",e)!==f));r.push(...t)}return Z(Z({},e),{},{nodes:r})}}})},onCompleted:()=>n.push("/"),onError:e=>v(e.message)}),C=k();return j?r.createElement(b.Z,{variant:"h5"},j.message):O?r.createElement(b.Z,{variant:"h6"},"Loading data..."):null!=w&&w.book?r.createElement(i.Z,null,r.createElement(l.Z,{container:!0},r.createElement(l.Z,{item:!0,md:6,xs:12},r.createElement(c.Z,null,r.createElement(s.Z,{title:w.book.title,subheader:"By ".concat(w.book.author.name,", ").concat((0,a.Z)(new Date(w.book.created),new Date)," ago")}),r.createElement(u.Z,null,r.createElement(b.Z,null,"Updated"," ",(0,a.Z)(new Date(w.book.created),new Date)," ago"),y?r.createElement(o.Z,{className:C.alert,onClose:()=>v(""),severity:"error"},y):""),r.createElement(d.Z,null,r.createElement(m.Z,{disabled:$,onClick:()=>P({variables:{id:f}}),type:"button",variant:"contained",color:"primary"},"Delete"),r.createElement(m.Z,{onClick:()=>h((e=>!e)),type:"button",variant:"contained",color:"primary"},g?"Close edit":"Edit"))),g?r.createElement(E,{id:w.book.id,title:w.book.title}):""))):r.createElement(b.Z,{variant:"h5"},"No book with that ID")}},5314:(e,t,n)=>{"use strict";n.d(t,{N2:()=>m,tJ:()=>p,RQ:()=>g,_n:()=>E,jV:()=>y});var r,a,o,i,l,c=n(985),s=n(5486);function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const d=(0,c.Ps)(r||(r=u(["\n    query Book($id: ID!) {\n  book(id: $id) {\n    id\n    title\n    author {\n      name\n    }\n    created\n    lastChanged\n  }\n}\n    "])));function m(e){return s.useQuery(d,e)}const b=(0,c.Ps)(a||(a=u(["\n    mutation DeleteBook($id: ID!) {\n  deleteBook(id: $id)\n}\n    "])));function p(e){return s.useMutation(b,e)}const f=(0,c.Ps)(o||(o=u(["\n    mutation CreateBook($title: String!) {\n  createBook(title: $title) {\n    id\n    title\n    created\n    lastChanged\n    author {\n      name\n    }\n  }\n}\n    "])));function g(e){return s.useMutation(f,e)}const h=(0,c.Ps)(i||(i=u(["\n    mutation UpdateBook($id: ID!, $title: String!) {\n  updateBook(id: $id, title: $title) {\n    id\n    title\n    created\n    lastChanged\n    author {\n      id\n      name\n      email\n    }\n  }\n}\n    "])));function E(e){return s.useMutation(h,e)}const k=(0,c.Ps)(l||(l=u(["\n    query Books($first: Int!, $after: String, $where: BooksWhereInput) {\n  books(first: $first, after: $after, where: $where) {\n    nodes {\n      id\n      title\n      created\n      lastChanged\n      author {\n        name\n      }\n    }\n    pageInfo {\n      endCursor\n      hasNextPage\n    }\n  }\n}\n    "])));function y(e){return s.useQuery(k,e)}}}]);
//# sourceMappingURL=665.bundle.js.map